<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>–î–ª—è —Ç–µ–±—è ‚ù§Ô∏è</title>

  <style>
    :root{
      --bg:#0b0a12;
      --card: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.10);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.68);
      --pink:#ff4da6;
      --violet:#9b5cff;
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --radius: 22px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
      background: radial-gradient(1200px 700px at 20% 10%, rgba(155,92,255,.22), transparent 60%),
                  radial-gradient(900px 600px at 80% 30%, rgba(255,77,166,.18), transparent 55%),
                  var(--bg);
      color:var(--text);
      overflow-x:hidden;
      -webkit-tap-highlight-color: transparent;
    }

    .bg-glow{
      position:fixed; inset:-40%;
      background: conic-gradient(from 180deg, rgba(255,77,166,.18), rgba(155,92,255,.18), rgba(255,77,166,.18));
      filter: blur(90px);
      opacity:.35;
      pointer-events:none;
      animation: float 10s ease-in-out infinite;
    }
    @keyframes float{
      0%,100%{transform: translate3d(-2%, -2%, 0) rotate(0deg)}
      50%{transform: translate3d(2%, 2%, 0) rotate(12deg)}
    }

    #hearts{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:0;
    }

    .hero{
      position:relative;
      z-index:1;
      padding: max(44px, env(safe-area-inset-top)) 16px 18px;
      display:flex;
      justify-content:center;
    }
    .hero__content{
      width:min(980px, 100%);
      text-align:center;
    }

    .badge{
      display:inline-flex;
      gap:10px;
      align-items:center;
      padding:10px 14px;
      border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid var(--stroke);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow);
      font-weight:600;
      color: var(--muted);
    }

    h1{
      margin:16px 0 10px;
      font-size: clamp(30px, 7vw, 56px);
      letter-spacing: -0.02em;
      line-height:1.05;
      background: linear-gradient(90deg, #fff, rgba(255,255,255,.75), #fff);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }
    .subtitle{
      margin:0 auto 16px;
      max-width: 62ch;
      color: var(--muted);
      font-size: clamp(14.5px, 3.8vw, 16.5px);
      padding: 0 6px;
    }

    .hero__actions{
      display:flex;
      justify-content:center;
      gap:12px;
      flex-wrap:wrap;
      margin-bottom:16px;
    }

    .btn{
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,77,166,.28), rgba(155,92,255,.18));
      color:var(--text);
      padding: 12px 16px;
      border-radius: 14px;
      cursor:pointer;
      box-shadow: var(--shadow);
      transition: transform .12s ease, border-color .2s ease;
      font-weight:700;
      user-select:none;
      min-height: 44px;
    }
    .btn:hover{transform: translateY(-1px); border-color: rgba(255,255,255,.26)}
    .btn:active{transform: translateY(0px) scale(.99)}
    .btn--ghost{
      background: rgba(255,255,255,.06);
      backdrop-filter: blur(10px);
    }
    .btn--small{
      padding:10px 14px;
      border-radius: 12px;
      font-weight:700;
      min-height: 44px;
    }

    .photo-card{
      margin: 16px auto 0;
      width:min(560px, 100%);
      background: var(--card);
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      overflow:hidden;
      box-shadow: var(--shadow);
      cursor:pointer;
      outline:none;
    }
    .photo-card img{
      width:100%;
      display:block;
      aspect-ratio: 16/10;
      object-fit: cover;
      filter: saturate(1.1) contrast(1.05);
    }
    .photo-card__hint{
      padding: 12px 14px;
      color: var(--muted);
      font-weight:600;
      font-size: 14px;
    }

    .container{
      position:relative;
      z-index:1;
      width:min(980px, 100%);
      margin: 0 auto;
      padding: 8px 16px 64px;
    }

    .grid{
      display:grid;
      gap:14px;
      grid-template-columns: repeat(12, 1fr);
    }

    .card{
      grid-column: span 6;
      background: var(--card);
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      padding: 16px 16px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
    }
    .card--wide{grid-column: span 12}

    @media (max-width: 820px){
      .card{grid-column: span 12}
    }

    .card h2{
      margin:0 0 10px;
      font-size: 20px;
      letter-spacing: -0.01em;
    }

    .muted{color: var(--muted)}
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top: 12px;
    }

    .love-list{
      margin:10px 0 0;
      padding-left:18px;
      color: var(--text)
    }
    .love-list li{margin: 8px 0; color: rgba(255,255,255,.86)}

    .pill-row{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top: 12px
    }
    .pill{
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.07);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(255,255,255,.86);
      font-weight:700;
      font-size: 13px;
    }

    .gallery{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
      margin-top: 10px;
    }
    @media (max-width: 560px){
      .gallery{grid-template-columns: repeat(2, 1fr)}
    }
    @media (min-width: 900px){
      .gallery{grid-template-columns: repeat(4, 1fr)}
    }

    .img-btn{
      padding:0;
      border:0;
      background:transparent;
      cursor:pointer;
    }
    .img-btn img{
      width:100%;
      aspect-ratio: 1 / 1;
      object-fit: cover;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 10px 24px rgba(0,0,0,.35);
      transition: transform .12s ease, filter .2s ease;
    }
    .img-btn:active img{transform: scale(.99)}
    .img-btn:hover img{filter: saturate(1.1)}

    .typewriter{
      min-height: 64px;
      padding: 12px 14px;
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      border:1px solid rgba(255,255,255,.10);
      font-size: 15px;
    }

    .cursor{
      opacity: 1;
      animation: blink 1s step-end infinite;
    }
    @keyframes blink{50%{opacity:0}}

    .footer{
      position:relative;
      z-index:1;
      padding: 18px 16px calc(18px + env(safe-area-inset-bottom));
      text-align:center;
      color: rgba(255,255,255,.78);
    }
    .heart{color: var(--pink)}

    .modal, .lightbox{
      position:fixed;
      inset:0;
      display:none;
      z-index:999;
    }
    .modal[aria-hidden="false"],
    .lightbox[aria-hidden="false"]{display:block}

    .modal__backdrop, .lightbox__backdrop{
      position:absolute; inset:0;
      background: rgba(0,0,0,.65);
      backdrop-filter: blur(6px);
    }

    .modal__content{
      position:relative;
      width:min(560px, calc(100% - 24px));
      margin: 12vh auto 0;
      background: rgba(20,18,30,.90);
      border:1px solid rgba(255,255,255,.14);
      border-radius: 20px;
      padding: 16px 16px 14px;
      box-shadow: var(--shadow);
    }
    @media (max-width: 560px){
      .modal__content{
        margin: auto;
        top: 0;
        transform: translateY(0);
        position:absolute;
        left: 12px;
        right: 12px;
        bottom: calc(12px + env(safe-area-inset-bottom));
        top: calc(12px + env(safe-area-inset-top));
        display:flex;
        flex-direction:column;
        justify-content:center;
      }
    }

    .modal__close, .lightbox__close{
      position:absolute;
      top: 10px; right: 10px;
      width: 44px; height: 44px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      cursor:pointer;
      font-size: 18px;
    }
    .big-cta{margin-top:14px; display:flex; justify-content:flex-end}

    .lightbox__content{
      position:relative;
      width:min(980px, calc(100% - 16px));
      margin: 6vh auto 0;
      background: rgba(10,9,16,.78);
      border:1px solid rgba(255,255,255,.14);
      border-radius: 22px;
      padding: 12px;
      box-shadow: var(--shadow);
    }
    @media (max-width: 560px){
      .lightbox__content{
        margin: 0;
        width: 100%;
        height: 100%;
        border-radius: 0;
        padding: calc(10px + env(safe-area-inset-top)) 10px calc(10px + env(safe-area-inset-bottom));
        display:flex;
        flex-direction:column;
        justify-content:center;
      }
    }

    .lightbox__content img{
      width:100%;
      max-height: 72vh;
      object-fit: contain;
      display:block;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.25);
      touch-action: pan-y;
    }

    .lightbox__caption{
      margin-top:10px;
      color: var(--muted);
      text-align:center;
      font-weight:600;
      font-size: 14px;
    }

    .lightbox__nav{
      position:absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 50px; height: 50px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      color: #fff;
      cursor:pointer;
      font-size: 30px;
      line-height: 46px;
    }
    .lightbox__nav--prev{left: 10px}
    .lightbox__nav--next{right: 10px}

    @media (max-width: 560px){
      .lightbox__nav{top:auto; transform:none; bottom: calc(12px + env(safe-area-inset-bottom));}
      .lightbox__nav--prev{left: 12px}
      .lightbox__nav--next{right: 12px}
    }
  </style>
</head>

<body>
  <div class="bg-glow"></div>
  <canvas id="hearts"></canvas>

  <header class="hero">
    <div class="hero__content">
      <div class="badge">14 —Ñ–µ–≤—Ä–∞–ª—è ‚Ä¢ –º–æ—ë –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ</div>
      <h1>–ú–∞–ª—ã—à, —è –ª—é–±–ª—é —Ç–µ–±—è ‚ù§Ô∏è</h1>
      <p class="subtitle">
        –¢—ã ‚Äî –º–æ—è –Ω–µ–∂–Ω–æ—Å—Ç—å, –º–æ–π –¥–æ–º –∏ –º–æ—ë —Å–∞–º–æ–µ –∫—Ä–∞—Å–∏–≤–æ–µ ¬´–Ω–∞–≤—Å–µ–≥–¥–∞¬ª.
      </p>

      <div class="hero__actions">
        <button class="btn" id="openSurprise">–û—Ç–∫—Ä—ã—Ç—å —Å—é—Ä–ø—Ä–∏–∑ ‚ú®</button>
        <button class="btn btn--ghost" id="toggleMusic">–ú—É–∑—ã–∫–∞: –≤—ã–∫–ª</button>
      </div>

      <div class="photo-card" id="mainPhoto" role="button" tabindex="0" aria-label="–û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ç–æ">
        <img src="liu.jpg" alt="–ú–æ—è –ª—é–±–∏–º–∞—è" />
        <div class="photo-card__hint">–ù–∞–∂–º–∏ –Ω–∞ —Ñ–æ—Ç–æ ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≥–∞–ª–µ—Ä–µ—è</div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="grid">
      <article class="card">
        <h2>–ü–æ—á–µ–º—É —è —Ç–µ–±—è –ª—é–±–ª—é</h2>
        <ul class="love-list">
          <li>–ó–∞ —Ç–≤–æ–∏ –≥–ª–∞–∑–∞ ‚Äî –≤ –Ω–∏—Ö —Ö–æ—á–µ—Ç—Å—è –∂–∏—Ç—å.</li>
          <li>–ó–∞ —Ç–≤–æ–π –≥–æ–ª–æ—Å ‚Äî –æ–Ω —É—Å–ø–æ–∫–∞–∏–≤–∞–µ—Ç –ª—É—á—à–µ –≤—Å–µ–≥–æ.</li>
          <li>–ó–∞ —Ç–≤–æ—é —É–ª—ã–±–∫—É ‚Äî –æ–Ω–∞ –¥–µ–ª–∞–µ—Ç –º–∏—Ä –¥–æ–±—Ä–µ–µ.</li>
          <li>–ó–∞ —Ç–æ, –∫–∞–∫–∞—è —Ç—ã –Ω–∞—Å—Ç–æ—è—â–∞—è.</li>
        </ul>
      </article>

      <article class="card">
        <h2>–ú–æ—ë –æ–±–µ—â–∞–Ω–∏–µ</h2>
        <p>
          –Ø –±—É–¥—É —Ä—è–¥–æ–º ‚Äî –≤ —Ä–∞–¥–æ—Å—Ç–∏ –∏ –≤ —Å–ª–æ–∂–Ω—ã–µ –¥–Ω–∏.
          –ë—É–¥—É –±–µ—Ä–µ—á—å —Ç–µ–±—è, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –Ω–∞–ø–æ–º–∏–Ω–∞—Ç—å, –∫–∞–∫–∞—è —Ç—ã –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–∞—è.
        </p>
        <div class="pill-row">
          <span class="pill">–Ω–µ–∂–Ω–æ—Å—Ç—å</span>
          <span class="pill">–∑–∞–±–æ—Ç–∞</span>
          <span class="pill">–≤–µ—Ä–Ω–æ—Å—Ç—å</span>
          <span class="pill">–º—ã</span>
        </div>
      </article>

      <article class="card card--wide">
        <h2>–ù–∞—à–∞ –≥–∞–ª–µ—Ä–µ—è</h2>
        <p class="muted">–ö–ª–∏–∫–∞–µ—à—å –ø–æ —Ñ–æ—Ç–æ ‚Äî –º–æ–∂–Ω–æ –ª–∏—Å—Ç–∞—Ç—å, —Å–≤–∞–π–ø–∞—Ç—å, –∑–∞–∫—Ä—ã—Ç—å –∫—Ä–µ—Å—Ç–∏–∫–æ–º.</p>

        <div class="gallery" id="gallery">
          <button class="img-btn"><img src="1.jpg" alt="–§–æ—Ç–æ 1"></button>
          <button class="img-btn"><img src="2.jpg" alt="–§–æ—Ç–æ 2"></button>
          <button class="img-btn"><img src="3.jpg" alt="–§–æ—Ç–æ 3"></button>
          <button class="img-btn"><img src="4.jpg" alt="–§–æ—Ç–æ 4"></button>
        </div>

        <div class="row">
          <button class="btn btn--small" id="downloadCurrent">–°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–µ–µ —Ñ–æ—Ç–æ ‚¨áÔ∏è</button>
        </div>
        <p class="muted" style="margin-top:10px; font-size:13px;">
          –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –Ω–∞ iPhone —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Ñ–æ—Ç–æ –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.
        </p>
      </article>

      <article class="card">
        <h2>–¢—ë–ø–ª—ã–µ —Å–ª–æ–≤–∞</h2>
        <div class="typewriter">
          <span id="typed"></span><span class="cursor">|</span>
        </div>
      </article>

      <article class="card">
        <h2>–ö–Ω–æ–ø–∫–∞ ¬´–î–∞¬ª üôÇ</h2>
        <p>–¢—ã –±—É–¥–µ—à—å –º–æ–µ–π –í–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ–π?</p>
        <div class="row">
          <button class="btn" id="yesBtn">–î–∞ ‚ù§Ô∏è</button>
          <button class="btn btn--ghost" id="noBtn">–ù–µ—Ç üôà</button>
        </div>
        <p class="muted" id="noHint"></p>
      </article>
    </section>
  </main>

  <footer class="footer">
    <div>–° –ª—é–±–æ–≤—å—é ‚Äî <span class="heart">‚ù§</span></div>
    <div class="muted">–°–¥–µ–ª–∞–Ω–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ–±—è</div>
  </footer>

  <div class="modal" id="surpriseModal" aria-hidden="true">
    <div class="modal__backdrop" data-close="true"></div>
    <div class="modal__content">
      <button class="modal__close" data-close="true" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      <h3>–°—é—Ä–ø—Ä–∏–∑ ‚ú®</h3>
      <p>
        –ï—Å–ª–∏ –±—ã –ª—é–±–æ–≤—å –±—ã–ª–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ–º ‚Äî —è –±—ã –æ—Ç–ø—Ä–∞–≤–ª—è–ª –µ–≥–æ —Ç–µ–±–µ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É.
        –¢—ã ‚Äî –º–æ—ë —Å–∞–º–æ–µ –∫—Ä–∞—Å–∏–≤–æ–µ —á—É–≤—Å—Ç–≤–æ.
      </p>
      <div class="big-cta">
        <button class="btn" id="confettiBtn">–°–∞–ª—é—Ç –¥–ª—è —Ç–µ–±—è üéâ</button>
      </div>
    </div>
  </div>

  <div class="lightbox" id="lightbox" aria-hidden="true">
    <div class="lightbox__backdrop" data-close="true"></div>
    <div class="lightbox__content">
      <button class="lightbox__close" data-close="true" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
      <button class="lightbox__nav lightbox__nav--prev" id="prev" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ">‚Äπ</button>
      <img id="lightboxImg" alt="–§–æ—Ç–æ" />
      <button class="lightbox__nav lightbox__nav--next" id="next" aria-label="–°–ª–µ–¥—É—é—â–µ–µ">‚Ä∫</button>
      <div class="lightbox__caption" id="caption"></div>
    </div>
  </div>

  <!-- ‚úÖ –ú—É–∑—ã–∫–∞: –ø–æ–ª–æ–∂–∏ 123.mp3 —Ä—è–¥–æ–º —Å index.html -->
  <audio id="audio" autoplay loop preload="auto" playsinline>
    <source src="123.mp3" type="audio/mp3">
  </audio>

  <script>
    // ===== Hearts canvas background =====
    const canvas = document.getElementById("hearts");
    const ctx = canvas.getContext("2d");

    function resize() {
      canvas.width = window.innerWidth * devicePixelRatio;
      canvas.height = window.innerHeight * devicePixelRatio;
    }
    resize();
    window.addEventListener("resize", resize);

    const hearts = [];
    function spawnHeart() {
      const size = (Math.random() * 10 + 8) * devicePixelRatio;
      hearts.push({
        x: Math.random() * canvas.width,
        y: canvas.height + size,
        vy: (Math.random() * 0.6 + 0.6) * devicePixelRatio,
        vx: (Math.random() * 0.6 - 0.3) * devicePixelRatio,
        size,
        rot: Math.random() * Math.PI,
        vr: (Math.random() * 0.02 - 0.01),
        alpha: Math.random() * 0.5 + 0.35
      });
      if (hearts.length > 90) hearts.shift();
    }

    function drawHeart(x, y, s, rot, a) {
      ctx.save();
      ctx.translate(x, y);
      ctx.rotate(rot);
      ctx.globalAlpha = a;

      const g = ctx.createLinearGradient(-s, -s, s, s);
      g.addColorStop(0, "rgba(255,77,166,.95)");
      g.addColorStop(1, "rgba(155,92,255,.85)");
      ctx.fillStyle = g;

      ctx.beginPath();
      const t = s / 16;
      ctx.moveTo(0, 6 * t);
      ctx.bezierCurveTo(0, 0, -8 * t, 0, -8 * t, 6 * t);
      ctx.bezierCurveTo(-8 * t, 10 * t, -4 * t, 12 * t, 0, 16 * t);
      ctx.bezierCurveTo(4 * t, 12 * t, 8 * t, 10 * t, 8 * t, 6 * t);
      ctx.bezierCurveTo(8 * t, 0, 0, 0, 0, 6 * t);
      ctx.closePath();
      ctx.fill();

      ctx.restore();
    }

    let last = 0;
    function animate(ts) {
      const dt = Math.min(32, ts - last);
      last = ts;

      if (Math.random() < 0.22) spawnHeart();

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (const h of hearts) {
        h.y -= h.vy * (dt / 16);
        h.x += h.vx * (dt / 16);
        h.rot += h.vr * (dt / 16);
        drawHeart(h.x, h.y, h.size, h.rot, h.alpha);
      }
      requestAnimationFrame(animate);
    }
    requestAnimationFrame(animate);

    // ===== Surprise modal =====
    const surpriseModal = document.getElementById("surpriseModal");
    const openSurprise = document.getElementById("openSurprise");

    function openModal(modal) {
      modal.setAttribute("aria-hidden", "false");
      document.body.style.overflow = "hidden";
    }
    function closeModal(modal) {
      modal.setAttribute("aria-hidden", "true");
      document.body.style.overflow = "";
    }

    openSurprise.addEventListener("click", () => openModal(surpriseModal));
    surpriseModal.addEventListener("click", (e) => {
      if (e.target.dataset.close) closeModal(surpriseModal);
    });

    // ===== Lightbox gallery =====
    const lightbox = document.getElementById("lightbox");
    const lightboxImg = document.getElementById("lightboxImg");
    const caption = document.getElementById("caption");
    const prevBtn = document.getElementById("prev");
    const nextBtn = document.getElementById("next");

    const galleryEl = document.getElementById("gallery");
    const images = Array.from(galleryEl.querySelectorAll("img")).map(img => ({
      src: img.getAttribute("src"),
      alt: img.getAttribute("alt")
    }));

    let index = 0;

    function show(i) {
      index = (i + images.length) % images.length;
      lightboxImg.src = images[index].src;
      lightboxImg.alt = images[index].alt;
      caption.textContent = `${images[index].alt} ‚Ä¢ ${index + 1}/${images.length}`;
    }

    function openLightbox(i) {
      show(i);
      lightbox.setAttribute("aria-hidden", "false");
      document.body.style.overflow = "hidden";
    }

    function closeLightbox() {
      lightbox.setAttribute("aria-hidden", "true");
      document.body.style.overflow = "";
    }

    galleryEl.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if (!btn) return;
      const img = btn.querySelector("img");
      const i = images.findIndex(x => x.src === img.getAttribute("src"));
      openLightbox(i);
    });

    const mainPhoto = document.getElementById("mainPhoto");
    mainPhoto.addEventListener("click", () => openLightbox(0));
    mainPhoto.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") openLightbox(0);
    });

    lightbox.addEventListener("click", (e) => {
      if (e.target.dataset.close) closeLightbox();
    });

    prevBtn.addEventListener("click", () => show(index - 1));
    nextBtn.addEventListener("click", () => show(index + 1));

    document.addEventListener("keydown", (e) => {
      if (lightbox.getAttribute("aria-hidden") === "false") {
        if (e.key === "Escape") closeLightbox();
        if (e.key === "ArrowLeft") show(index - 1);
        if (e.key === "ArrowRight") show(index + 1);
      }
      if (surpriseModal.getAttribute("aria-hidden") === "false" && e.key === "Escape") {
        closeModal(surpriseModal);
      }
    });

    // swipe on mobile
    let startX = null;
    lightboxImg.addEventListener("touchstart", (e) => {
      startX = e.touches[0].clientX;
    }, {passive:true});

    lightboxImg.addEventListener("touchend", (e) => {
      if (startX === null) return;
      const dx = e.changedTouches[0].clientX - startX;
      if (Math.abs(dx) > 40) show(index + (dx < 0 ? 1 : -1));
      startX = null;
    }, {passive:true});

    // ===== Download current image =====
    document.getElementById("downloadCurrent").addEventListener("click", () => {
      const url = images[index].src;
      const a = document.createElement("a");
      a.href = url;
      a.download = url.split("/").pop();
      document.body.appendChild(a);
      a.click();
      a.remove();
    });

    // ===== Typewriter text =====
    const typed = document.getElementById("typed");
    const phrases = [
      "–Ø –ª—é–±–ª—é —Ç–µ–±—è –∑–∞ —Ç–æ, –∫–∞–∫ —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å –º–∏—Ä.",
      "–†—è–¥–æ–º —Å —Ç–æ–±–æ–π –º–Ω–µ —Å–ø–æ–∫–æ–π–Ω–æ –∏ –ª–µ–≥–∫–æ.",
      "–¢—ã ‚Äî –º–æ—è —Å–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –º–µ—á—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è —Å—Ç–∞–ª–∞ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é.",
      "–° 14 —Ñ–µ–≤—Ä–∞–ª—è, –ª—é–±–∏–º–∞—è. –Ø –≤—ã–±–∏—Ä–∞—é —Ç–µ–±—è ‚Äî –∫–∞–∂–¥—ã–π –¥–µ–Ω—å."
    ];

    let pi = 0, ci = 0;
    function typeLoop() {
      const text = phrases[pi];
      typed.textContent = text.slice(0, ci++);
      if (ci <= text.length) return setTimeout(typeLoop, 28);

      setTimeout(() => {
        ci = 0;
        pi = (pi + 1) % phrases.length;
        typeLoop();
      }, 1100);
    }
    typeLoop();

    // ===== Music toggle + autoplay on enter =====
    const audio = document.getElementById("audio");
    const toggleMusic = document.getElementById("toggleMusic");
    let musicOn = false;

    // –ø—Ä–æ–±—É–µ–º –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    window.addEventListener("load", async () => {
      try {
        audio.volume = 0.8;
        await audio.play();
        musicOn = true;
        toggleMusic.textContent = "–ú—É–∑—ã–∫–∞: –≤–∫–ª";
      } catch {
        toggleMusic.textContent = "–ú—É–∑—ã–∫–∞: –Ω–∞–∂–º–∏";
      }
    });

    // 100% –∑–∞–ø—É—Å–∫ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞—Ö: –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Ç–∞–ø–µ/–∫–ª–∏–∫–µ
    document.addEventListener("click", () => {
      if (!musicOn) {
        audio.play().then(() => {
          musicOn = true;
          toggleMusic.textContent = "–ú—É–∑—ã–∫–∞: –≤–∫–ª";
        }).catch(()=>{});
      }
    }, { once:true });

    // —Ä—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–æ–π
    toggleMusic.addEventListener("click", async () => {
      try {
        if (!musicOn) {
          await audio.play();
          musicOn = true;
          toggleMusic.textContent = "–ú—É–∑—ã–∫–∞: –≤–∫–ª";
        } else {
          audio.pause();
          musicOn = false;
          toggleMusic.textContent = "–ú—É–∑—ã–∫–∞: –≤—ã–∫–ª";
        }
      } catch {
        alert("–ú—É–∑—ã–∫–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ñ–∞–π–ª 123.mp4 –ª–µ–∂–∏—Ç —Ä—è–¥–æ–º —Å index.html (–∏–ª–∏ –ø—É—Ç—å —É–∫–∞–∑–∞–Ω –≤–µ—Ä–Ω–æ).");
      }
    });

    // ===== Funny "No" button =====
    const noBtn = document.getElementById("noBtn");
    const noHint = document.getElementById("noHint");
    let noCount = 0;

    function moveNoButton() {
      noCount++;
      const x = Math.random() * 240 - 120;
      const y = Math.random() * 140 - 70;
      noBtn.style.transform = `translate(${x}px, ${y}px)`;
      noHint.textContent = noCount < 3
        ? "–û–π‚Ä¶ –∫–Ω–æ–ø–∫–∞ ¬´–ù–µ—Ç¬ª —É–±–µ–∂–∞–ª–∞ üòÑ"
        : "–ö–∞–∂–µ—Ç—Å—è, —Å—É–¥—å–±–∞ –≤—Å—ë —Ä–µ—à–∏–ª–∞ –∑–∞ –Ω–∞—Å ‚ù§Ô∏è";
    }

    noBtn.addEventListener("mouseenter", moveNoButton);
    noBtn.addEventListener("click", (e) => {
      e.preventDefault();
      moveNoButton();
    });

    document.getElementById("yesBtn").addEventListener("click", () => {
      openModal(surpriseModal);
    });

    // ===== Confetti (simple) =====
    document.getElementById("confettiBtn").addEventListener("click", () => {
      for (let i = 0; i < 160; i++) spawnHeart();
    });
  </script>
</body>
</html>
